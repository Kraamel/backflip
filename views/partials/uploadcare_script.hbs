{{! requires jquery}}
<script>
  UPLOADCARE_LOCALE = "{{{locale}}}";
  UPLOADCARE_TABS = "file url camera";
  UPLOADCARE_PUBLIC_KEY = "{{{uploadcarePublicKey}}}";
  UPLOADCARE_IMAGES_ONLY = true;
  UPLOADCARE_CLEARABLE = true;
</script>
<script src="/javascripts/uploadcare.min.js"></script>
<script>
function installWidgetPreviewSingle(widget, div) {
  widget.onChange(function(file) {
    if (file) {
      file.done(function(fileInfo) {
        var previewUrl = fileInfo.cdnUrl;
        div.css('background-image', 'url("'+previewUrl+'")');
      });
    }
  });
}
$(function() {
  $('.image-preview-single').each(function() {
    installWidgetPreviewSingle(
      uploadcare.SingleWidget($('#uploadcare')),
      $(this)
    );
  });
});
</script>
